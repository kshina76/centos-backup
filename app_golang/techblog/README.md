# techblog開発memo

## 大まかな構成
- 作るもの
    - techblog

- 使用技術
    - HTML/CSS
    - JavaScript
        - 一部をスクロールさせたり、目次をクリックしたら飛んでいく動作をさせたりするため
        - staticファイルの中にjsを作成して、htmlからはscriptタグで読み出す
    - Go言語
    - Go言語標準ライブラリ

- アプリケーションアーキテクチャの構成
    - レイヤー構成
        - 3層(小規模なので、データアクセス層はいらないので実質2層)
    - プレゼンテーション層の構成
        - MVC
        - コントローラー
            - マルチプレクサとURLディスパッチャが二つでコントローラとして機能する
            - main.goがURLディスパッチャ
        - モデル
            - データベース自体の定義
            - データベースへの処理はここが担当する
            - CRUDとかビューにデータを返したり
            - ハンドラ関数はここに定義しない
            - dataディレクトリにまとめる
        - ビュー
            - ハンドラ関数が定義されたgoファイルが複数
            - データとテンプレートを混ぜて表示する処理を担当
            - リダイレクトなども行う
            - 必要に応じてモデルにアクセスする
                - データの取得
                - 受け取ったデータをモデルに渡してCRUD操作をしてもらう
    - ビジネスロジック層
        - ドメインモデル
            - モデルにCRUDなどの振る舞いを実装するという意味でこの言葉を使っている

- 気をつけること
    - ちゃんとMVCに沿っているかを確認しながら開発をする
        - https://www.slideshare.net/MugeSo/mvc-14469802
    - オブジェクト指向を意識する
        - 自分のREADMEを読んだり、本を読み直したり

<br></br>

## 詳細な構成(作業する順に書いている)

- 機能設計
    - スーパーユーザ(admin) 最初に作る
        - メールアドレス,passwordでサインインできる
        - email,passwordでサインインできる
        - ログアウトすることができる
        - ブログの記事に対してCRUD操作ができる
            - 記事作成とかはmarkdownを導入したい
        - ユーザを作ることができる(ブログ執筆者)
    - 一般ユーザ(ブログ閲覧者) スーパーユーザができてから作る
        - 目的のブログ、プロフィールを閲覧できる
        - 記事を検索できる
        - ランキングを見ること、クリックして記事に飛ぶことができる
        - タグをクリックして関連記事をフィルター表示できる
        - 目次をクリックすると見出しのところに自動スクロールしてくれる
            - HTMLのページ内リンクという機能がある
    - ブログ
        - 自動で目次作成
        - ページネーション
        - ページ内リンク(目次を押したらそこにジャンプ)
            - https://saruwakakun.com/html-css/reference/link_jump

- 画面遷移設計とデザイン
    - 「figma」というUI/UXツールでページのデザインを作成
        - Frameを意識することで、HTMLタグの付け方が頭に浮かんできて、後々のコーディング作業で楽になるという付加効果もある
    - ページネーションor無限スクロール
        - とりあえずページネーションを選択

- DB設計

- アーキテクチャ設計、クラス設計

- システム構成設計

- 注意点
    - 小規模な場合はこの設計でいいけど、大規模な場合はもっと詳細な設計を行う必要がある

- 参考文献
    - https://note.com/promitsu/n/n463792216407

<br></br>

---

## 開発メモ

- ログインのプロセス
    1. login.htmlでフォームを設置
    2. ログイン画面を表示するハンドラ関数loginを定義
    3. login.htmlのフォームのactionで「/authenticate」のURIを指定
        - フォームのactionは指定されたURIにmethodで指定されたリクエストを送る動作をする
        - authenticateはhtmlを用意する必要はない。/authenticateにアクセスされた時に処理をするハンドラ関数を定義すればいいだけ
    4. ログイン処理をするハンドラ関数authenticateを定義

- テンプレート名が同じ場合は切り替えることでテンプレートを変えることができる

- go言語でMVCモデルを実現すると(開発を進める前にMVCを意識しながら開発を進めると何から進めればいいかわかりやすい)
    - コントローラー
        - マルチプレクサとURLディスパッチャが二つでコントローラとして機能する
        - main.goがURLディスパッチャ
    - モデル
        - データベース自体の定義
        - データベースへの処理はここが担当する
            - CRUDとかビューにデータを返したり
        - ハンドラ関数はここに定義しない
        - dataディレクトリにまとめる
    - ビュー
        - ハンドラ関数が定義されたgoファイルが複数
        - データとテンプレートを混ぜて表示する処理を担当
        - リダイレクトなども行う
        - 必要に応じてモデルにアクセスする
            - データの取得
            - 受け取ったデータをモデルに渡してCRUD操作をしてもらう

- go言語でのディレクトリの分け方
    - パッケージの分け方など
    - https://sanzo83.hatenablog.com/entry/2019/05/01/235039

---

# go言語のメソッドなどの使い方
## template系
- template.ParseFiles(htmlfiles...)
    - htmlテンプレートを解析するメソッド
    - htmlファイルの順番はなんでもいい

- ExecuteTemplate(書き込む場所, テンプレートタグ名, テンプレートに渡す引数)
    - 書き込む場所
        - writerを指定するとhttpレスポンスに書き込む
        - os.Stdoutを指定すると標準出力に書き込む(デバッグに使える)
    - テンプレートタグ名
        - {{define "base"}}を指定したhtmlファイルを実行したかったら、"base"を渡す
        - 他のテンプレートタグは芋づる式に実行されるから渡さなくていい
    - テンプレートに渡す引数
        - なければnilを指定すればいい

- Execute(書き込む場所, テンプレートに渡す引数)
    - ExecuteTemplateの方を使えばいいと思う

---

