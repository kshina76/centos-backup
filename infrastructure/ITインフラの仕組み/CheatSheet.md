# ITインフラのチートシート

## Webデータの流れ
- チューニングする際にこの図と自分が構築したシステムアーキテクチャを見比べて、どこをチューニングするかの指標にする
  - 例えば、どの部分をキャッシュすればいいのかとか
  - どの部分をキャッシュサーバを使って高速化するかとか
- トラブルシューティングをする際に、順を追ってトラブルシューティングするのに使える

- 参考文献
  - https://enterprisezine.jp/article/detail/13392
### 全体の流れ

![13392_01](https://user-images.githubusercontent.com/53253817/102695047-541ab300-4268-11eb-95c9-513d6e0bb587.png)

### クライアントPCからWebサーバーへのデータの流れ
1. Webブラウザからリクエストが発行される
2. 名前解決が行なわれる
3. Webサーバーがリクエストを受け付ける
4. Webサーバーが静的コンテンツか、動的コンテンツかを判断する
5. 必要な経路でデータにアクセスする

![13392_02](https://user-images.githubusercontent.com/53253817/102695048-54b34980-4268-11eb-8383-c014b693b965.png)

### クライアントPC上でのWebブラウザの起動

![13392_03](https://user-images.githubusercontent.com/53253817/102695049-55e47680-4268-11eb-99e6-270a94423644.png)

### 名前解決の仕組み

![13392_04](https://user-images.githubusercontent.com/53253817/102695051-5715a380-4268-11eb-8520-49c8408137b6.png)

### WebサーバーからAPサーバーのデータの流れ
1. Webサーバーからのリクエストが到着する
2. スレッドがリクエストを受け取り、自分で計算できるのか、DBへの接続が必要か判断する
3. DBへの接続が必要な場合、コネクションプールにアクセスする
4. 4,5でDBサーバーにリクエストを投げる

![13392_05](https://user-images.githubusercontent.com/53253817/102695157-efac2380-4268-11eb-82ce-4d046f645200.png)

### DBサーバー以外の選択肢

![13392_06](https://user-images.githubusercontent.com/53253817/102695158-f0dd5080-4268-11eb-8ac1-88c7f5fe11f2.png)

### APサーバーからDBサーバーに来て、戻るまでのデータの流れ
1. APサーバーからのリクエストが到着する
2. プロセスがリクエストを受け取り、キャッシュが存在するか確認する
3. キャッシュになければ、ディスクにアクセスする
4. ディスクからデータが返る
5. データをキャッシュとして格納する
6. 結果をAPサーバーに返す

![13392_07](https://user-images.githubusercontent.com/53253817/102695159-f175e700-4268-11eb-9b95-674833d76c28.png)

### Oracle Databaseのプロセス間での作業分担

![13392_08](https://user-images.githubusercontent.com/53253817/102695161-f2a71400-4268-11eb-9e1c-6dee2781b772.png)

### 外部ストレージ装置へのアクセス

![13392_09](https://user-images.githubusercontent.com/53253817/102695162-f33faa80-4268-11eb-8ee7-a3578d795df6.png)

### APサーバーからWebサーバーに戻るまでのデータの流れ
1. DBサーバーからのデータが到着する
2. スレッドがデータを元に計算等を加え、ファイルデータを生成する
3. 結果をWebサーバーに返す

![13392_10](https://user-images.githubusercontent.com/53253817/102695232-444f9e80-4269-11eb-8ee8-bf7fdb70fed7.png)

### WebサーバーからクライアントPCに戻るまでのデータの流れ
1. APサーバーからのデータが到着する
2. プロセスは受け取った結果をそのまま返す
3. 結果がWebブラウザに返り、画面に表示される

![13392_11](https://user-images.githubusercontent.com/53253817/102695234-46196200-4269-11eb-9c7d-6186431b1a2a.png)

---

<br></br>
