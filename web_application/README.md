# プロになるためのWeb技術入門

- アプリケーションの種類
    1. デスクトップアプリケーション
        - 主な処理は手元のPC上で行われる
        - 画面はOSの機能を利用して表示されている
        - アプリケーションをPCにインストールする必要がある
        - インストールされたPC上でのみ動作する
        - 特にiPhoneやandroidやタブレットにインストールして使用するアプリケーションをネイティブアプリという
    2. Webアプリケーション
        - 主な処理はサーバ上で行われる
        - 画面はブラウザの機能を利用して表示される
        - インストールが不要

---

- Webが発展した歴史
    - Webとは
        - WWW(World-Wide-Web)を略した名称がweb
    
    - インターネットとは
        - 世界中のコンピュータが相互に通信できるようにしたネットワーク網
    
    - WWWとは
        - インターネットを使って情報共有するための仕組み
        - CERNという研究所が研究成果をHTMLで記述することで、研究の文献などをハイパーリンクで辿って、情報共有できるようにした
            - ハイパーリンクで辿れることが「蜘蛛の巣」のように見えることからWWWと名付けられた
    
    - NCSA Mosaic
        - 画像の配置やグラフィカルな見た目を表示できるブラウザ
        - WWWが登場した当初のブラウザは色や画像などを表示することができなかったことから生まれた
        - このブラウザが改良されてIEやFirefoxなどが開発された
        - この頃では、まだ静的コンテンツを提供することしかできなかった
    
    - CGI
        - webサーバとバックエンドのプログラムの間でリクエストとレスポンスをやりとりするための規約
        - 動的コンテンツをユーザに提供するために誕生した
        - クライアントから渡されたリクエストをCGIからプログラムに送って、プログラムが動的コンテンツのHTMLを生成して返し、そのレスポンスをCGIが受け取って、Webサーバに渡して、webサーバからクライアントにHTMLが返ってくる
        - プログラムはPerlやCが使われていた
            - CGI=perlは間違いで、CGIが普及していた時にバックエンドのプログラムとして活躍していた言語がPerlということ
        - CGIの問題点
            1. Perlは簡単なテキスト処理はできるけど、大規模なシステムには不向きな言語。オブジェクト指向もない
            2. Webブラウザからリクエストが届くたびにプロセスを起動させていたから、速度が遅かった
                - webページにアクセスしても画面が表示されるのに時間がかかった
    
    - Java/サーブレット
        - CGIの問題点を解決するために登場した
        - サーブレットのCGIと違うところが、Webサーバと同じプロセスの中で、動的にコンテンツを生成することができたから速度が速かった
        - Javaもオブジェクト指向を装備していたことでweb開発で使われるようになった
        - JavaVMのおかげで、異なるプラットフォームでも同じものを動作させることができた
            - linuxやwindowsやiosのどこでも同じものを動かすことができた
        - サーブレットの問題点
            - Javaの出力命令を使ってHTMLを出力するから、プログラムが書きにくい
    
    - JSP
        - HTMLにJavaのコードを埋め込むことを可能にした
            - <% %>で囲むと埋め込める
        - サーブレットはJavaのコード内にHTMLを埋め込んでいたが、その逆の発想
    
    - Webアプリケーションフレームワーク
        - サーブレットやJSPを一から作るのは大変
        - 機能をまとめたライブラリが登場して、さらに発展することでフレームワークが登場した
        - これによってさらに開発が楽になった

---


- URL(Uniform Resource Locator)
    - インターネット上のコンテンツを一意に指定するための仕組み

    - 「http://www.littleforest.jp/webtext/index.html」 の構造
        - スキーム名
            - リソースを取得するための方法
            - 「http」にあたる部分
            - 他にもmailto, ftp, file といったスキームが存在する
        - ホスト名
            - リソースが存在するホスト(コンピュータ)名を表している
                - 処理した結果を返すようなコンピュータをホストコンピュータという
            - 「www.littleforest.jp」に当たる部分
                - wwwは「ローカル名」といい、wwwサーバというコンピュータを表す
                - littleforest.jpは「親ドメイン名」といい、日本(jp)のlittleforestという組織を表す
        - パス名
            - webtext/index.htmlに当たる部分。コンピュータ上のリソースの位置
    
    - URI
        - URLとURNの総称のこと
            - URNは現在だとあまり使われていないため、ほぼURI=URLだと思っていい
    
---

- HTTPでは一回で一つのリソースを取得
    - imgタグで囲まれたHTMLが搭載されたWebページにアクセスすると、なぜかHTMLのリクエストをした後にimgタグの分だけ何回もリクエストが送られる
        - これはHTTPでは一回で一つのリソースを取得することから、このような動作になる

---

- ファイル名を省略したリクエスト
    - Webサーバの昨日で、デフォルトのページを設定することができる
        - 大抵index.htmlなどにアクセスするようになっている
    - 「http://gihyo.jp/」のようにファイルのパスが省略されているのは、この機能を使っている

---

- TCP/IP
    - IPアドレスを頼りに情報を届けるプロトコル
    - ブラウザから受け取ったHTTPリクエストなどの情報をパケットという単位に分割して送信して、受信側で組み立て直す
        - この動作をTCP/IPが責任を持って行っている
    - アプリケーション層のプロトコルは全てTCP/IPの上で成り立っていて、宛先のコンピュータを指定するためにIPアドレスを使用する
        - HTTP, SMTP, POP3, FTP, telnet, sshなど
    - TCP/IPがどのタイプのアプリケーションを処理するかはポート番号によって識別される
        - よく使われるポート番号はウェルノウンポートと呼ばれる
---

- グローバルIPアドレス
    - 身近で使用しているグローバルIPアドレスは「動的なIPアドレス」といって、モデムやルータの電源を入れ直した時や、定期的に変更される
        - 変更されるタイミングはISP(インターネットサービスプロバイダ)による
    - プロバイダとの契約によっては固定IPを割り振ることもできる

- グローバルIPアドレスから住所などが特定される危険性
    - グローバルIPから直接逆引きするのは難しい
        - 国とか地域ぐらいしかわからない
        - 地域に関しては、少し離れた市町村が表示されたり
    - 逆引きして大まかな位置を絞って、SNSなどを使って特定することは可能
        - https://pc-pier.com/blog/2020/03/18/get-identified/
        - こういうので有名人の匿名掲示板への書き込みがバレたりするのかな

---

- 自由に使用していいプライベートIPアドレス
    - 10.0.0.0 ~ 10.255.255.255
        - クラスA
            - 利用可能な個数 : 16,777,216個
    - 172.16.0.0 ~ 172.31.255.255
        - クラスB
            - 利用可能な個数 : 1,048,576個
    - 192.168.0.0 ~ 192.168.255.255
        - クラスC
            - 利用可能な個数 : 65,536個
    - 通常はそんなにLAN内で接続するコンピュータの数は多くないので、クラスCで設定されていることが多い
    - 自分の大学だと、まあまあコンピュータがあるからクラスBの範囲で指定されているのだと思う

---

- DNS
    - ドメイン名をIPアドレスに変換する機能
    - ドメインを一つのサーバで管理するのは大変なので、「.」区切りで木構造のように管理されている
        - DNSサーバの大元はルートDNSサーバといって、「jp」や「com」といったドメインが登録されている
            - その下に色々なドメインが木構造で登録されていく
            - 「jp」や「com」などをTLD(トップレベルドメイン)という
    - 例えば、「http://www.littleforest.jp/webtext/index.html」のドメインのlittleforest.jpをDNSサーバで管理したら
        - ルートDNSサーバにjpが登録されている->jpドメインのDNSサーバ->jpドメインのDNSサーバにlittleforestが登録されている->名前解決
            - このように辿って行きながら名前解決される

---

- GETメソッドによるパラメータ渡し
    - HTMLのformでGETを指定してもパラメータを渡すことができる
    - クライアントからformに入力してsubmitすると、クエリ文字列としてURLにパラメータが載せられてサーバにリクエストされる
    - リクエストを取得して覗いてみると、一行目のリクエストラインにクエリ文字列が並んでいる
    - 問題点
        - GETメソッドでパラメータを渡してしまうと、大事な情報でもURLに記述されるため、傍受されていたら第三者に情報が渡ってしまう

- POSTメソッドによるパラメータ渡し
    - HTMLのformでPOSTを指定するよく使われるやり方
    - POSTで行うと、クエリ文字列としてURLに記述されないで、リクエストのメッセージボディに変数と値が記述されるようになる
    - この方法だとURLから推測されない。
    - メッセージボディのものはwebサーバのログに残ることは少ない。技術的には可能だが、膨大になるため残さない
        - 残る可能性もあるため、セキュリティには注意を払う必要がある

- GETとPOSTの使い分け
    - ログインや決済やformの内容が長すぎる際はPOSTを使うべき
        - 「副作用がある」というように表現される
        - URLは文字数制限がある
    - 外に渡っても問題ない情報や短いformの場合はGETを使う
        - 例えば、amazon内での商品の検索結果など
            - このような場合には積極的に利用する。なぜなら商品の検索結果を友達に送る際などにURLを送るだけでそのページを参照できるから

    ![ec625236-19b5-a265-69a1-1dbd0aab7e18](https://user-images.githubusercontent.com/53253817/97304339-ede46600-189e-11eb-8716-e46fd5eb6c8b.png)


- パーセントエンコード
    - 文字列を16進数の文字コードで表したもの
    - 日本語や空白といった文字列をクエリ文字列として渡すには、パーセントエンコードする必要がある
    - この処理はブラウザ側で自動的に行われる

---

- FTPはステートフルなプロトコル、HTTPはステートレスなプロトコル
    - ステートレスなHTTPプロトコルで状態を保持するにはCookieを使う
    - ログイン認証などにはログインしているという状態を保持しなければいけないので、Cookieが使われる
        - 単純にformでPOSTで認証情報送って判定するだけのプログラムだと、状態が保持されないので、毎回入力してログインしなければいけないという手間が発生する

- Cookie
    - ステートレスなプロトコルに情報を持たせるための技術
    - レスポンスヘッダのSet-Cookieで設定できる
    - 手順
        1. webサーバからwebブラウザにHTTPレスポンスのヘッダを利用して小さい情報を送る(この仕組みをCookieという)
        2. webブラウザが次回同じwebサーバにアクセスする際に、受け取ったCookieをそのままHTTPリクエストのヘッダに入れて送る
        3. webアプリケーションは、リクエストヘッダに入っているCookieを調べることで誰がログインしてきたかを知ることができる
    - ログイン認証の実装の場合、ログアウトが押されたあとは、Cookieを送らないように削除する仕組みが必要

---

# Webアプリケーション開発の手順
- 要求分析
    - お客さんの仕事の流れなどから、どのようなことをしたいのか、どんなシステムだと現状の問題を解決できるのかということを分析する
- 画面遷移図
    - UIの遷移をスケッチする
    - 例えば、ログイン画面の遷移図なら、ログインに成功した場合はどのような画面になるのか、失敗したらどのような画面になるのかというスケッチ
- 画面モックを作る
    - HTMLとCSSのみで作られたハリボテのサイト
        - 遷移先の画面なども含めて
        - リンクやロジックは実装していないので、URLから直接入力して画面を確認する
    - このフェーズではバックエンドなどの実装は行わなくていい
    - お客さんにプロトタイプを見せるために
- 実際のロジックの作成(例えば、ログインの認証機能など)
    - 機能を実装したら一つ一つ動作を確認するようにする

# 用語
- 帯域幅とは

- クラウドネイティブとは
    - クラウドを使ったシステムを構築することを優先すること

# 気になること
- 任意のサイトにリクエストを送って、HTTPリクエストとレスポンスを取得して表示してみる
    - windowsだと「横取り丸」と「Inetspy」を使うとできるが、go言語とかでサーバ立てて取得すればいい気がする

# 参考文献
- プロになるためのWeb技術入門
- 上記の書籍のHTTPらへんをきれいにまとめているブログ
    - https://qiita.com/Sekky0905/items/dff3d0da059d6f5bfabf