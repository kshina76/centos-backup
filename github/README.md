# GitHub書籍メモ

- Notification
  - 「@ユーザ名」...ユーザにメンションを送ってメッセージを送信できる
  - 「@組織名」...組織全体にメンションを送信できる
  - 「@組織名/チーム名」...組織に属するチーム全体にメンションを送信できる
  - 「#番号」...そのリポジトリのissue番号にリンクとなる
  - 「ユーザ名/リポジトリ名#番号」...指定したリポジトリへのリンクとなる

---

## それぞれのコマンドの説明

### local
- git init
  - 初期化して.gitを作り、gitの管理対象にするコマンド
  - すでに開発が進んでいるものをcloneした場合は、.gitは最初から作られているのでinitコマンドは使わなくていい
  - .gitが作られていることでgitに管理されることになり、gitのコマンド類が使えるようになる。コマンドの結果は全て.gitに保存されるようになる
  - initをしただけだと、リモートリポジトリの設定がまだだから、git remoteコマンドで設定をしないとダメ

- git addコマンド
  - ステージ領域へファイルを追加

- git commit
  - ローカルリポジトリにリポジトリの歴史を記録
  - この記録を元にワーキングツリーを復元したりする
  - 1行のコミットメッセージならmオプションをつけてコミット
  - 詳細なコミットメッセージならオプションをつけずにコミットすることで、エディタが立ち上がる。フォーマットは以下に準ずる。

    ```
    1行目    コミットする変更内容の要約を1行で記述
    2行目    空行
    3行目以降    変更した理由や詳細を記述
    ```

### log

- git status
  - 前回のコミットと比較した変更内容を表示する
  - gitリポジトリの状態を確認するコマンド
  - 状態は目まぐるしく変わるから、このコマンドで常に確認するようにする

- git log
  - コミットのログを確認

- git diff
  - 「ワークツリー、ステージ領域、最新コミット」間の差分を確認するのに利用するコマンド
  - 「git diff HEAD」コマンドを実行するとワークツリーと最新コミットの差分を確認する。HEADは作業しているブランチの最新のコミットを参照するポインタ。
    - git commitコマンドを実行する前に、このコマンドを実行して前回のコミットとどのような差分があるかを確認する癖をつける



### remote

- git remote -v
  - URLも含めた一覧表示

- git remote add <任意名> <URL>
  - リモートリポジトリを登録
  - 慣習でoriginがよく使われる

- git remote rm <リモートリポジトリの名前>
  - リモートリポジトリの情報を削除

- git fetch
  - リモートリポジトリの最新の状態をローカルリポジトリのリモート追跡ブランチにダウンロードする。
  - ワーキングツリーに影響はない
  - 何も引数に渡さないとgit fetch origin masterが実行される
  - git fetch origin/develop develop とかできるのかな？

- git clone
  - cloneの場合はgit remoteのコマンドはいらない。クローンした時点でoriginにURLが登録される


- git push <リモートリポジトリ> <ローカルブランチ名>
  - git push origin master
      - ローカルブランチのmasterをリモートリポジトリのorigin上の「同名のブランチ」に反映するという意味
  - git push origin master:master
      - 省略せずに書いたパターン
      - ローカルのmasterブランチをリモートのmasterブランチに反映
  - https://www-creators.com/archives/1472


### branch

- git branch --all
  - ブランチを一覧表示
  - allをつけるとリモート追跡ブランチも表示する(ローカルリポジトリにリモートリポジトリの情報を保存しているところ)

- git branch <ブランチ名>
  - ブランチを新規作成

- git branch -m <変更前> <変更後>
  - ブランチ名を変更

- git branch -d <ブランチ名>
  - ブランチを削除
  - Dオプションにすると強制削除

- git checkout <ブランチ名>
  - ブランチを切り替える

- git checkout -b <ブランチ名>
  - ブランチを新規作成して切り替える
    - 作成と切り替えを同時に行う

- git merge
  - ブランチをマージ
  - 統合ブランチにcheckoutしてから、mergeコマンドでトピックブランチを指定することでマージできる
  - トピックブランチは事前にコミットしておくこと
  - 「git merge --no-ff <トピックブランチ>」
    - エディタが立ち上がるが、デフォルトで記述されているから変更しなくていい
  - mergeはあくまでもローカルリポジトリ内の操作なので、リモートリポジトリに反映させたい場合は、mergeの後にmergeしたローカルリポジトリをpushする


## 色々な手順
- mainブランチにdevelopブランチをマージ
  - 本当はdiffやstatusで状態を確認しながらマージしないとダメ

  ```bash
  $ git branch develop      # developブランチを作成
  $ git checkout develop    # developブランチに移行
  $ git add .               # ステージング環境に反映
  $ git commit -m "add"     # ローカルリポジトリに反映
  $ git push origin develop # リモートリポジトリに反映(コミットしたらプッシュはすぐにする癖をつける。コンフリクトしないように)
  $ git checkout main       # マージしたい方に移行する(忘れずに。移行しないとマージできないから)
  $ git merge main develop  # mainブランチにdevelopブランチをマージ(ローカル)
  $ git push origin main    # リモートのmainブランチに反映
  ```

- PullRequestを送る
  - Forkしないパターン(企業内での開発はこっちが一般的かな)
    - https://qiita.com/samurai_runner/items/7442521bce2d6ac9330b
  - Forkするパターン(OSSに参加するならこっちかな)
    - https://qiita.com/aipacommander/items/d61d21988a36a4d0e58b


## わかったこと
- コミットしたらすぐにプッシュすること
  - コンフリクトを避けるために

- 変更を反映したいブランチがある場合は、その変更したいブランチにcheckoutしてから反映作業を行う
  - mergeでもpushでもcommitでもなんでも

- 実際の開発ではPullRequestを投げるので、mergeコマンドを使うことはないかも(mergeは権限がある人だけ)
  - developブランチから派生したfeatureブランチなどにpushして、developにmergeしてもらうためにPullRequestを投げるというかんじ

- ブランチAからブランチBのように異なるブランチ間のプッシュは使わない気がする
  - ブランチBにブランチAをマージして、ブランチBをプッシュすれば、実現できるのでこのように行うといいと思う

---

# githubを使った開発の進め方
- 参考文献(https://qiita.com/sekiyaeiji/items/d0312c90bff4c37bc5dc)

# githubブランチについてのまとめ  
- 参考文献(https://qiita.com/katsunory/items/252c5fd2f70480af9bbb)
## ブランチの名前付け
### master
- リリース可能な状態だけを管理する
- 特定のブランチからマージすることによってしか更新されない
- 直接コミットしてはならないという制約をもつ
- バージョンごとのtagはここから生まれる
- いつでもリリースできるロボットを表す

### develop/[バージョン番号など]
- 先のリリースに向けた普段の開発で使用する
- 後述のfeatureやreleaseブランチはここから派生
- 開発中のロボット全体を表す

### feature/[派生元バージョン番号など]/[機能名など]
- 機能追加改修などを行う作業ブランチ
- developブランチから、featureブランチを切る
- 完了後はdevelopブランチにマージされて、featureブランチは削除される
- ロボットの一部分を表す。例えば、[feature/foot]というブランチなら、ロボットの足の開発の部分を表す。

### その他
- release/[バージョン番号]
- fix/[バージョン番号]/[バグ識別名]
- support/[バージョン番号]
- hotfix/[バージョン番号]/[バグ識別名] or hotfix/[バグ識別名]
